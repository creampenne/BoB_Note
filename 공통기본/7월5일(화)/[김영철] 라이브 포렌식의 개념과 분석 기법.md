# 라이브 포렌식의 개념과 분석 기법
**07/05/2022**  

## 컴퓨터 대상 디지털 증거의 수집 방법

### 라이브 포렌식
- 활성 시스템 포렌식
### 데드 포렌식
- 컴퓨터 대상 포렌식 = 데드 포렌식
### 레저렉션
- 기존에 수집한 증거를 토대로 다시 시스템을 구성하여 가동하는 것

침해사고 대응에서는 피해를 최소화하기 위해 **수집 없이 바로 분석 및 대응**하는 경우도 있기 때문에, 라이브 포렌식을 <**활성 시스템을 대상으로 한 수집 및 분석**>으로 이해하는 것이 바람직

## 라이브 포렌식 / 라이브 데이터 수집
- 둘의 개념이 다르다
- 라이브 포렌식 : 대상 시스템의 운영 및 작동을 중단하지 않은 상태에서 디지털 증거를 수집
- 라이브 데이터 : 활성 중인 데이터의 수집

## 전통적인 디지털포렌식 절차와 라이브 포렌식
**대상 컴퓨터의 상태에 따라 현장에서 결정**

## 라이브 포렌식이 필요한 경우
- 시스템을 중단 시 해당 시스템을 이용 중인 사람들의 피해가 예상되는 경우
- 시스템을 중단 시 대상 범죄자가 자신이 수사 대상이라는 사실을 알아차릴 수 있는 경우
- 활성 상태에서 수집할 수 있는 데이터의 가용도가 비활성 상태에서 수집할 수 있는 데이터에 비해 현저히 높은 경우 (TPM)
- 휘발성 정보를 수집할 필요가 있는 경우
- 기타의 이유로 서비스를 중단할 수 없는 경우

## 해당 시스템을 이용 중인 사람들의 피해가 예상되는 경우
- 대상 시스템이 서버 시스템인 경우
- **라이브 포렌식으로 디지털 증거 수집의 목적을 달성하기 현저히 곤란하다면 적절한 절차를 통해 시스템 운영을 중단시키고 데드 포렌식을 수행**
- (해당 시스템 운영의 주목적이 범죄의 도구로 이용하는 것인 경우나 이용자들이 불법 또는 위법한 목적으로 해당 시스템을 이용 중이라면, 별다른 절차 없이 해당 시스템의 운영을 중단할 수 있음)

## 범죄자가 자신이 수사 대상이라는 사실을 알아차릴 수 있는 경우
- 보통 침해사고 대응에서 **실시간으로 공격자를 추적**하거나, **대상 시스템에 범죄자가 RDP(Remote Desktop Protocol) 등을 통해 원격 접속하는 경우**
- **범죄자가 대상 시스템에 접속해 있거나 접속할 것으로 예상되는 경우**

### 보안 사고 처리 대응 방안
1. 보호 및 속행 : 로그를 남기지 않음
2. 추적 및 기소 : 로그를 남김

## 활성 시스템에서 수집한 데이터의 가용도가 현저히 높은 경우
- 악성코드가 난독화 되어 있는 경우
- 디스크 또는 볼륨 수준 암호화가 적용되어 있는 경우

**위의 두 경우에는 난독화 또는 암호화된 대상 원본 데이터를 수집하는 것이 아니기 때문에 동일성 입증을 위한 추가 조치(복호화된 파일에 대한 피압수자 확인 또는 암호화된 데이터의 수집 등)가 필요**

#### 전문법칙(제310조의2) : 진술증거는 전문법칙의 예외를 제외하고는 기본적으로 증거능력이 없다.
#### 전문법칙의 예외 (제311조~제316조) - 증거 능력이 있다.
1. 311조 : 법관 법원의 조서
2. 312조 : 신빙할 수 있는 상태에서 검사 또는 사법경찰관의 조서
3. 313조 : 성립의 진정이 증명된 제3자의 진술서, 진술자가 성립의 진정을 부인할 경우 과학적분석결과에 기초한 디지털 포렌식, 감정 등 객관적 방법으로 성립의 진정이 증명될 때 증거로 할 수 있다.
4. 314조 : 진술자가 진술불능(사망, 질병, 해외 거주)에도 특히 신빙할 수 있는 상태의 조서 및 서류는 증거 사용 가능
5. 315조 : 등본,초본 등 공무원, 외국공무원이 직무상 증명 가능한 문서 / 상업 장부, 항해 일지 등 업무상 필요로 작성된 통상 문서
6. 316조 : 제3자의 진술이 제3자에 대한 진술로 내용을 특히 신빙할 수 있는 상태의 진술. 이때 진술자가 진술불능일때 증거가능

#### 위법수집증거배제법칙 (제308조의2)
- 적법한 절차에 따르지 않는 경우 증거로 할 수 없다.
- 위법하게 수집한 증거로 부터 파생된 2차적 증거 또한 증거로 사용할 수 없습니다.(독수독과 이론)
- 그러나 모든 2차적 증거가 제한될 경우 실체적 진실 규명이 어렵게 될 수 있다. 오염희석이론, 불가피한 발견의 이론, 독립된 증거원의 이론, 선의의 신뢰의 이론 등 독수독과의 예외의 이론에 해당하는 경우 증거로 인정 받을 수 있다.

## 휘발성 데이터를 수집할 필요가 있는 경우
RFC3227 휘발 순서

## 필수적으로 메모리를 수집해야 하는 경우
- 소위 메모리 인젝션 악성코드라 불리는 **인 메모리 인젝션 악성코드**
- 수집 대상에 암호화된 파일이 존재하거나 디스크/볼륨 단위 암호화
- 운영체제가 설치된 볼륨이 암호화되어 있고 운영체제 로그온이 정상적

## 기타의 이유로 운영을 중단할 수 없는 경우
- 클라우드 기반의 가상화로 구현된 컴퓨팅 환경의 경우

## 휘발성 데이터로서의 공인 IP

## 로카르드의 교환 법칙과 문서화
- 로카르드의 교환 법칙 : 접촉하는 두 개체는 서로의 흔적을 주고 받음
- 로카르드의 교환 법칙은 범죄자에겜ㄴ 적용된느 것이 아니라, 조사/수사 과정에서 증거를 취급하는 조사관/수사관에게도 적용됨
- 라이브 포렌식은 그 특성 상, 불가피하게 대상 데이터에 변경을 초래함
- 수집한 이미지나 복제본을 대상으로 수행하는 일반적인 디지털포렌식 분석 과정과는 달리, 라이브 포렌식에서는 한번 번경된 데이터를 원래 상태로 되돌리는 것은 불가능함
- 따라서 **라이브 포렌식 과정에서 불가피하게 생성,삭제,변경된 데이터를 구분하고, 수집 과정에 있었던 모든 행위(시간,행위,결과 등)를 문서화**할 필요가 있음

## 압수,수색 원칙의 변화
제106조(압수) 3항 :  
법원은 압수의 목적물이 컴퓨터용디스크, 그 밖에 이와 비슷한 정보저장매체(이하 이 항에서 “정보저장매체등”이라 한다)인 경우에는 **기억된 정보의 범위를 정하여 출력하거나 복제하여 제출**받아야 한다. 다만, 범위를 정하여 출력 또는 복제하는 방법이 불가능하거나 압수의 목적을 달성하기에 현저히 곤란하다고 인정되는 때에는 정보저장매체등을 압수할 수 있다.  <신설 2011. 7. 18.>  

위 조항을 <**기억된 정보의 범위를 정하여 출력**> 또는 <**기억된 정보의 범위를 정하여 복제**>로 해석하지 않고, <**기억된 정보의 범위를 정하여 출력**> 또는 <**복제**>로 해석한 것에 기인함

## 선별 압수와 라이브 포렌식의 관계
1. 분석용 컴퓨터의 자원을 이용하는 방식 : 대부분 이 방법
2. 대상 컴퓨터의 자원을 이용하는 방식 : 극히 제한적

## 무설치 방식 디지털포렌식 도구의 운용
- 메모리의 변화는 어쩔 수 없는 것, 디스크의 변화를 기록하지 않는 것이 중요
- CD와 USB의 장점을 결합해, USB 메모리의 일부 영역을 CDFS으로 설정하여 무설치 방식 디지털포렌식 도구를 저장하고, 나머지 영역에는 수집한 데이터를 저장하는 방식을 주로 이용

## 선별 압수 원칙에 따른 디지털포렌식 증거 수집 절차의 변화
- 우리나라에서는 라이브 포렌식 방식으로 선별 압수를 수행하되, 수행 과정에서 포괄 압수 사유가 발견될 경우에 한하여 포괄 압수로 전환하는 방식으로 증거 수집이 이루어짐
- 선별 압수 과정에서 포괄 압수 사유가 있는지 확인
- 형사소송법 제106조 3항의 **해당 사유에 대한 문서화를 수행하고 피압수자 또는 참관인의 확인을 받는 식으로 객관성을 확보**해야 함

> 점유 이전 - 디지털 포렌식 관점에서 이전과 동시에 원본 데이터의 폐지  
> 복제 용이성(이전 불가성) - 복사가 쉬워서. 디지털 데이터는 이전이 불가능

라이브 포렌식에서 가장 중요한 점 : 문서화

여담1 : CD, HDD, SSD는 비휘발성이라고 생각하지만 휘발성 데이터라고도 생각할 수 있겠당당구리
여담2 : 가상화폐 거래소 보여주기 식으로 추적 및 기소 가능

키워드 : DFIR(Digital Foresics & Incident Response), RFC3227, colocation, CFTT

너무 어렵다.........................  
나는 영장류인가보다...................